#include <stdio.h>
#include <stdlib.h>



int main(){

    unsigned int seed;
    long i;
    int en1,en2;
    FILE *flag_file= fopen("flag.enc","rb");

    if(flag_file == NULL){
        printf("could not open file");
        return 1;
    }

    //read the first 4 bytes
    fread(&seed,1,4,flag_file);

    //determine the file size
    fseek(flag_file,0,SEEK_END);
    size_t size_of_flag = ftell(flag_file);
    fseek(flag_file,0,SEEK_SET);

    //allocate memory to store file content
    unsigned char *flag= malloc(size_of_flag);


    //read file content
    fread(flag,size_of_flag,1,flag_file);

    fclose(flag_file);

    //passing the seed to random function
    srand(seed);

    // decryption i is giveb the vaue of 4 to avoid the first 4 bytes
    for (i = 4; i < (long)size_of_flag; i = i + 1) {
        en1 = rand();
        en2 = rand();
        en2 = en2 & 7;

        // left shift bitwise encryption
        flag[i] = flag[i] >> en2 | flag[i] << 8 - en2;

        //XOR operation
        flag[i] = en1 ^ flag[i];
        printf("%C",flag[i]);

  }

return 0;


}




